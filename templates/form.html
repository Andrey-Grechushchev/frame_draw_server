
  <!--
    –§–û–†–ú–ê –ì–ï–ù–ï–†–ê–¶–ò–ò PDF-–ß–ï–†–¢–ï–ñ–ê –ö–ê–†–ö–ê–°–ê

    –°—Ç—Ä—É–∫—Ç—É—Ä–∞:
    - –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ:
        * –ì–µ–æ–º–µ—Ç—Ä–∏—è –∫–∞—Ä–∫–∞—Å–∞ (–¥–ª–∏–Ω–∞, –¥–∏–∞–º–µ—Ç—Ä, —à–∞–≥ –º–µ–∂–¥—É –∫–æ–ª—å—Ü–∞–º–∏ –∏ —Ç.–ø.).
        * –ú–∞—Ç–µ—Ä–∏–∞–ª –ø—Ä–æ–≤–æ–ª–æ–∫–∏, —Ç–∏–ø –∑–∞–º–∫–∞, —Ç–∏–ø –ø–æ–∫—Ä—ã—Ç–∏—è, —Ç–∏–ø –æ–≥–æ–ª–æ–≤–∫–∞.
        * –ù–∞–ª–∏—á–∏–µ –¥–æ–Ω—ã—à–∫–∞, –Ω–∞–ª–∏—á–∏–µ –í–µ–Ω—Ç—É—Ä–∏ –∏ —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Ä–∞–∑–º–µ—Ä—ã.
        * –°–ø—Ä–∞–≤–æ—á–Ω—ã–µ —Ä–∞–∑–º–µ—Ä—ã (–¥–ª–∏–Ω–∞ –≥–æ—Ä–ª–æ–≤–∏–Ω—ã, —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –æ—Ç –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –∫–æ–ª—å—Ü–∞ –¥–æ –¥–æ–Ω—ã—à–∫–∞).
        * –ë–ª–æ–∫ –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥–ª–∏–Ω—ã –∫–∞—Ä–∫–∞—Å–∞ (–∫–æ–ª-–≤–æ —à–∞–≥–æ–≤, —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ —Ä–∞—Å—á—ë—Ç–Ω–æ–π –∏ –≤–≤–µ–¥—ë–Ω–Ω–æ–π –¥–ª–∏–Ω—ã).
    - –û—Å–Ω–æ–≤–Ω–∞—è –Ω–∞–¥–ø–∏—Å—å:
        * –ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ –∏–∑–¥–µ–ª–∏—è.
        * –§–ò–û/–∏–Ω–∏—Ü–∏–∞–ª—ã —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞, –ø—Ä–æ–≤–µ—Ä—è—é—â–µ–≥–æ, –Ω–æ—Ä–º–æ–∫–æ–Ω—Ç—Ä–æ–ª—è, —É—Ç–≤–µ—Ä–∂–¥–∞—é—â–µ–≥–æ –∏ —Ç.–ø.
    - –ò–º—è —Ñ–∞–π–ª–∞:
        * –ò–º—è PDF-—Ñ–∞–π–ª–∞ (–±–µ–∑ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è), –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø—Ä–∏ —Å–∫–∞—á–∏–≤–∞–Ω–∏–∏.

    UI/UX:
    - –ö–∞–∂–¥—ã–π –±–ª–æ–∫ –æ—Ñ–æ—Ä–º–ª–µ–Ω —á–µ—Ä–µ–∑ <fieldset> + <legend>.
    - –ù–∞–¥ —Ñ–æ—Ä–º–æ–π –µ—Å—Ç—å <details> —Å –∫—Ä–∞—Ç–∫–æ–π –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–µ–π –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
    - –û—Å–Ω–æ–≤–Ω—ã–µ –ø–æ–ª—è –≤—ã—Ä–æ–≤–Ω–µ–Ω—ã –≤ –¥–≤–µ –∫–æ–ª–æ–Ω–∫–∏.
    - –°—Ç—Ä–æ–∫–∏ —Å —á–µ–∫–±–æ–∫—Å–∞–º–∏ —Å–≤–µ—Ä—Å—Ç–∞–Ω—ã —Ç–∞–∫, —á—Ç–æ–±—ã –≤—Å–µ –≥–∞–ª–æ—á–∫–∏ —Å—Ç–æ—è–ª–∏ –ø–æ –æ–¥–Ω–æ–π –≤–µ—Ä—Ç–∏–∫–∞–ª–∏,
      –∞ —Ç–µ–∫—Å—Ç —Å–ø—Ä–∞–≤–∞ –º–æ–≥ –ø–µ—Ä–µ–Ω–æ—Å–∏—Ç—å—Å—è –ø–æ —Å—Ç—Ä–æ–∫–∞–º.

    –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∞—è –ª–æ–≥–∏–∫–∞ (JavaScript):
    - –û—Ç–ø—Ä–∞–≤–∫–∞ —Ñ–æ—Ä–º—ã:
        * –ü–µ—Ä–µ—Ö–≤–∞—Ç —Å–æ–±—ã—Ç–∏—è submit, —Å–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö —á–µ—Ä–µ–∑ FormData.
        * POST-–∑–∞–ø—Ä–æ—Å –Ω–∞ /generate —Å –∑–∞–≥–æ–ª–æ–≤–∫–æ–º Authorization: Bearer secure_token_Aspex.
        * –£—Å–ø–µ—à–Ω—ã–π –æ—Ç–≤–µ—Ç -> –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ PDF (blob + <a download>).
        * –ò–º—è —Ñ–∞–π–ª–∞ –±–µ—Ä—ë—Ç—Å—è –∏–∑ –ø–æ–ª—è filename, –Ω–µ–±–µ–∑–æ–ø–∞—Å–Ω—ã–µ —Å–∏–º–≤–æ–ª—ã –∑–∞–º–µ–Ω—è—é—Ç—Å—è –Ω–∞ "_".
        * –û—à–∏–±–∫–∏ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ alert() (–ª–∏–±–æ HTTP-—Å—Ç–∞—Ç—É—Å, –ª–∏–±–æ —Ç–µ–∫—Å—Ç –∏–∑ JSON-–æ—Ç–≤–µ—Ç–∞).

    - "–õ–æ–≥–∏—á–µ—Å–∫–æ–µ –æ—Ç–∫–ª—é—á–µ–Ω–∏–µ" –ø–æ–ª–µ–π:
        * setDisabledLike(...) –¥–µ–ª–∞–µ—Ç –ø–æ–ª—è —Å–µ—Ä—ã–º–∏ –∏ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã–º–∏ –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è,
          –Ω–æ –Ω–µ —Å—Ç–∞–≤–∏—Ç native disabled, —á—Ç–æ–±—ã –∑–Ω–∞—á–µ–Ω–∏—è –≤—Å—ë —Ä–∞–≤–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª—è–ª–∏—Å—å –Ω–∞ —Å–µ—Ä–≤–µ—Ä.
        * –î–ª—è <select> –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è pointer-events: none.

    - –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –∏ —Å—Ç–æ—Ä–æ–∂–∞:
        * frame_parts_count:
            - –ü—Ä–∏ 1 —á–∞—Å—Ç–∏ –∑–∞–º–æ–∫ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ "–ë–µ–∑ –∑–∞–º–∫–∞", –ø–æ–ª–µ –∑–∞–º–∫–∞ –±–ª–æ–∫–∏—Ä—É–µ—Ç—Å—è.
            - –ü—Ä–∏ 2‚Äì3 —á–∞—Å—Ç—è—Ö –Ω–µ–¥–æ–ø—É—Å—Ç–∏–º "–ë–µ–∑ –∑–∞–º–∫–∞" ‚Äî –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –º–µ–Ω—è–µ—Ç—Å—è –Ω–∞ "–ö–æ–≥–æ—Ç—å".
        * wire_material:
            - –î–ª—è –Ω–µ—Ä–∂–∞–≤–µ—é—â–∏—Ö –º–∞—Ä–æ–∫ (12–•18–ù9, 12–•18–ù10–¢, 08–•18–ù10) –¥–æ–ø—É—Å–∫–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ "–ë–µ–∑ –æ–∫—Ä–∞—Å–∫–∏".
            - –ü–æ–ø—ã—Ç–∫–∞ –≤—ã–±—Ä–∞—Ç—å "–û–∫—Ä–∞—Å–∫–∞"/"–û—Ü–∏–Ω–∫–æ–≤–∫–∞" –æ—Ç–∫–∞—Ç—ã–≤–∞–µ—Ç—Å—è —Å –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ–º.
        * venturi_presence:
            - –ü—Ä–∏ –≤—ã–∫–ª—é—á–µ–Ω–∏–∏ –≥–∞—Å–∏—Ç –ø–æ–ª—è –¥–∏–∞–º–µ—Ç—Ä–∞ –∏ —Ç–æ–ª—â–∏–Ω—ã –í–µ–Ω—Ç—É—Ä–∏.
            - –ü—Ä–∏ –≤–∫–ª—é—á–µ–Ω–∏–∏ –±–ª–æ–∫–∏—Ä—É–µ—Ç —á–µ–∫–±–æ–∫—Å "–í–Ω—É—Ç—Ä. –¥–∏–∞–º–µ—Ç—Ä –∫–æ–ª—å—Ü–∞ —Ä–∞—Å—Ç—Ä—É–±–∞".
        * bottom_presence:
            - –ü—Ä–∏ –≤—ã–∫–ª—é—á–µ–Ω–∏–∏ –≥–∞—Å–∏—Ç –ø–æ–ª—è —Ç–æ–ª—â–∏–Ω—ã –∏ –≤—ã—Å–æ—Ç—ã –¥–æ–Ω—ã—à–∫–∞.
        * neck_length_presence / last_ring_to_bottom_length_presence:
            - –í–∫–ª—é—á–∞—é—Ç/–≤—ã–∫–ª—é—á–∞—é—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ —á–∏—Å–ª–æ–≤—ã–µ –ø–æ–ª—è.
        * head_type:
            - –¢–∏–ø –æ–≥–æ–ª–æ–≤–∫–∞ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω (–ø–æ —Å—É—Ç–∏ "–†–∞—Å—Ç—Ä—É–±") –∏ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è.

    - –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–ª–∏–Ω—ã –∫–∞—Ä–∫–∞—Å–∞:
        * –í—Ö–æ–¥–Ω—ã–µ –ø–æ–ª—è:
            - frame_length_mm ‚Äî –≤–≤–µ–¥—ë–Ω–Ω–∞—è –¥–ª–∏–Ω–∞ –∫–∞—Ä–∫–∞—Å–∞.
            - neck_length ‚Äî –¥–ª–∏–Ω–∞ –≥–æ—Ä–ª–æ–≤–∏–Ω—ã.
            - distance_between_rings ‚Äî —à–∞–≥ –º–µ–∂–¥—É –∫–æ–ª—å—Ü–∞–º–∏.
            - last_ring_to_bottom_length ‚Äî —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –æ—Ç –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –∫–æ–ª—å—Ü–∞ –¥–æ –¥–æ–Ω—ã—à–∫–∞.
            - frame_parts_count ‚Äî –¥–ª—è —Ä–∞—Å—á—ë—Ç–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∑–∞–º–∫–æ–≤.
        * –†–∞—Å—á—ë—Ç:
            - lockCount = max(frame_parts_count - 1, 0).
            - lockAdd = lockCount * 24 –º–º (—É–≤–µ–ª–∏—á–µ–Ω–∏–µ –¥–ª–∏–Ω—ã –æ—Ç –∑–∞–º–∫–æ–≤).
            - usable = L - neck - last - lockAdd.
            - nSteps ‚âà usable / step (–æ–∫—Ä—É–≥–ª–µ–Ω–∏–µ –¥–æ –±–ª–∏–∂–∞–π—à–µ–≥–æ —Ü–µ–ª–æ–≥–æ).
            - reconstructed = neck + nSteps * step + last + lockAdd.
        * –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ:
            - calc_segment_count ‚Äî —Ä–∞—Å—Å—á–∏—Ç–∞–Ω–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —à–∞–≥–æ–≤.
            - calc_frame_length:
                - –ø—Ä–∏ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–∏: "reconstructed = L –º–º" (–∑–µ–ª—ë–Ω—ã–π —Ñ–æ–Ω);
                - –ø—Ä–∏ —Ä–∞—Å—Ö–æ–∂–¥–µ–Ω–∏–∏: "reconstructed > L –º–º" –∏–ª–∏ "reconstructed < L –º–º"
                  (–∂—ë–ª—Ç—ã–π/–∫—Ä–∞—Å–Ω—ã–π —Ñ–æ–Ω –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –≤–µ–ª–∏—á–∏–Ω—ã –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—è);
                - –ø—Ä–∏ –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–º –≤–≤–æ–¥–µ: "–û—à–∏–±–∫–∞" (–∫—Ä–∞—Å–Ω—ã–π —Ñ–æ–Ω).
            - frame_length_formula ‚Äî —Ç–µ–∫—Å—Ç–æ–≤–∞—è —Ñ–æ—Ä–º—É–ª–∞ —Å –ø–æ–¥—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏
              (–≤–∫–ª—é—á–∞—è –≤–∫–ª–∞–¥ –∑–∞–º–∫–æ–≤).

    –ó–∞–º–µ—á–∞–Ω–∏—è –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏:
    - –í—Å–µ –∏–º–µ–Ω–∞ –ø–æ–ª–µ–π (name= / id=) —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω—ã —Å —Å–µ—Ä–≤–µ—Ä–Ω–æ–π —á–∞—Å—Ç—å—é –∏ GUI-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ–º.
    - –ù–µ –º–µ–Ω—è—Ç—å name/id –±–µ–∑ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è backend –∏ Tkinter-–ª–æ–≥–∏–∫–∏.
    - –¢–æ–∫–µ–Ω –∏ URL /generate –¥–ª—è –ø—Ä–æ–¥–∞ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –≤—ã–Ω–µ—Å–µ–Ω—ã –≤ –∫–æ–Ω—Ñ–∏–≥ / –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è.
  -->


<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>–§–æ—Ä–º–∞ –≤–≤–æ–¥–∞</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body { font-family: sans-serif; background: #f5f5f5; padding: 20px; }
    form { background: #fff; padding: 20px; border-radius: 8px; max-width: 1000px; margin: auto; }
    fieldset { margin-bottom: 20px; border: 1px solid #ccc; border-radius: 8px; padding: 15px; }
    legend { font-weight: bold; }
    label { display: block; margin: 10px 0 5px; }
    input, select { width: 100%; padding: 5px; box-sizing: border-box; }

    /* –°—Ç—Ä–æ–∫–∏ —Å –≥–∞–ª–æ—á–∫–∞–º–∏: 2 –∫–æ–ª–æ–Ω–∫–∏ ‚Äî —Å–ª–µ–≤–∞ —á–µ–∫–±–æ–∫—Å —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–π —à–∏—Ä–∏–Ω—ã, —Å–ø—Ä–∞–≤–∞ —Ç–µ–∫—Å—Ç */
    .checkbox-label,
    .inline-group {
      display: grid;
      grid-template-columns: 20px 1fr; /* 20px –ø–æ–¥ —á–µ–∫–±–æ–∫—Å, –æ—Å—Ç–∞–ª—å–Ω–æ–µ –ø–æ–¥ —Ç–µ–∫—Å—Ç */
      column-gap: 6px;
      align-items: flex-start;
      margin: 6px 0;
    }

    /* –°–∞–º–∞ –≥–∞–ª–æ—á–∫–∞ –≤—Å–µ–≥–¥–∞ –≤ –ª–µ–≤–æ–π –∫–æ–ª–æ–Ω–∫–µ, –ø—Ä–∏–∂–∞—Ç–∞ –∫ –Ω–∞—á–∞–ª—É */
    .checkbox-label input[type="checkbox"],
    .inline-group input[type="checkbox"] {
      justify-self: start;
      margin: 2px 0 0 0;  /* —á—É—Ç—å –æ–ø—É—Å—Ç–∏—Ç—å, —á—Ç–æ–±—ã —Ü–µ–Ω—Ç—Ä —Å–æ–≤–ø–∞–¥–∞–ª —Å –ø–µ—Ä–≤–æ–π —Å—Ç—Ä–æ–∫–æ–π —Ç–µ–∫—Å—Ç–∞ */
    }

    /* –£ —Ç–µ–∫—Å—Ç–∞ —Ä—è–¥–æ–º —Å –≥–∞–ª–æ—á–∫–æ–π —É–±–∏—Ä–∞–µ–º –≤–Ω–µ—à–Ω–∏–π margin,
      —á—Ç–æ–±—ã –æ–Ω –Ω–µ —Ä–∞–∑–¥—É–≤–∞–ª –≤—ã—Å–æ—Ç—É —Å—Ç—Ä–æ–∫–∏ */
    .checkbox-label label,
    .inline-group label {
      margin: 0;
    }

    button { padding: 10px 20px; font-size: 16px; }
    
    .field-grid {
      display: grid;
      grid-template-columns: repeat(2, minmax(0, 1fr));
      gap: 8px 20px; /* –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—ã–π –∏ –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω—ã–π –æ—Ç—Å—Ç—É–ø—ã */
      align-items: flex-start;
    }

    .field {
      width: 100%;
    }

    /* –ü–æ–ª–µ –Ω–∞ –≤—Å—é —à–∏—Ä–∏–Ω—É (–¥–ª—è —á–µ–∫–±–æ–∫—Å–æ–≤ –∏ —Ç.–ø.) */
    .field.full-width {
      grid-column: 1 / -1;
    }

    /* –ß—É—Ç—å —É–º–µ–Ω—å—à–∏–º –≤–Ω–µ—à–Ω–∏–µ –æ—Ç—Å—Ç—É–ø—ã —É label –≤–Ω—É—Ç—Ä–∏ .field,
      —á—Ç–æ–±—ã —Å–µ—Ç–∫–∞ –≤—ã–≥–ª—è–¥–µ–ª–∞ –ø–æ–ø–ª–æ—Ç–Ω–µ–µ */
    .field label {
      margin: 0 0 5px;
    }

    /* –ß—Ç–æ–±—ã —á–µ–∫–±–æ–∫—Å-–≥—Ä—É–ø–ø—ã –∫—Ä–∞—Å–∏–≤–æ —Å–º–æ—Ç—Ä–µ–ª–∏—Å—å –≤ —Å–µ—Ç–∫–µ */
    .field .checkbox-label,
    .field .inline-group {
      margin-top: 0;
    }

    .disabled-like { opacity: 0.6; }
    select.disabled-like {
      pointer-events: none;
      cursor: default;
    }

    /* --- –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–ª–∏–Ω—ã –∫–∞—Ä–∫–∞—Å–∞ --- */
    .result-field {
      font-weight: 600;
    }
    .result-ok {
      background-color: #e6ffe6;
      color: #006400;
    }
    .result-warn {
      background-color: #fff8e5;
      color: #8a6d3b;
    }
    .result-error {
      background-color: #ffe6e6;
      color: #a94442;
    }
    #frame_length_formula {
      font-size: 0.9em;
      margin-top: 4px;
      color: #555;
    }

  </style>
</head>
<body>

  <!-- <details style="max-width: 1000px; margin: auto; background: #fff; padding: 15px; border-radius: 8px; border: 1px solid #ccc; margin-bottom: 20px;">
    <summary style="font-size: 18px; font-weight: bold; cursor: pointer;">‚ÑπÔ∏è –ö–∞–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è —Ñ–æ—Ä–º–æ–π</summary>
    <div style="margin-top: 10px;">
      <p>1. –ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è –≤ —Ä–∞–∑–¥–µ–ª–∞—Ö:</p>
      <ul>
        <li><strong>–û—Å–Ω–æ–≤–Ω–∞—è –Ω–∞–¥–ø–∏—Å—å</strong> ‚Äî –¥–ª—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤—â–∏–∫–µ –∏ —É—Ç–≤–µ—Ä–∂–¥–∞—é—â–µ–º.</li>
        <li><strong>–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ</strong> ‚Äî –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∫–∞—Ä–∫–∞—Å–∞ –∏ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–∏–≤–Ω—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤.</li> -->
        <!-- <li><strong>–°–ø—Ä–∞–≤–æ—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ</strong> ‚Äî –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–∞–∑–º–µ—Ä—ã.</li> -->
        <!-- <li><strong>–ò–º—è —Ñ–∞–π–ª–∞</strong> ‚Äî –∫–∞–∫ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ñ–∞–π–ª.</li>
      </ul>
      <p>2. –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É <strong>¬´–°–æ—Ö—Ä–∞–Ω–∏—Ç—å —á–µ—Ä—Ç—ë–∂¬ª</strong>.</p>
      <p>3. –ü–æ—Å–ª–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∑–∞–ø—Ä–æ—Å–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–∫–∞—á–∞–µ—Ç—Å—è PDF-—Ñ–∞–π–ª —Å —á–µ—Ä—Ç–µ–∂–æ–º.</p> -->
      <!-- <p>üîê –î–æ—Å—Ç—É–ø –∑–∞—â–∏—â—ë–Ω ‚Äî –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–æ–∫–µ–Ω –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏. –ï—Å–ª–∏ –µ–≥–æ –Ω–µ—Ç –∏–ª–∏ –æ–Ω –Ω–µ–≤–µ—Ä–Ω—ã–π, –ø—Ä–æ–∏–∑–æ–π–¥—ë—Ç –æ—à–∏–±–∫–∞ –¥–æ—Å—Ç—É–ø–∞.</p> -->
      <!-- <p>üìÑ –§–∞–π–ª —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ –∏ –ø–µ—Ä–µ–¥–∞—ë—Ç—Å—è –≤–∞–º –∫–∞–∫ –∑–∞–≥—Ä—É–∑–∫–∞. –ï—Å–ª–∏ –≤–æ–∑–Ω–∏–∫–∞–µ—Ç –æ—à–∏–±–∫–∞ ‚Äî –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –ø–æ–ª–µ–π.</p>
    </div>
  </details> -->


  <form id="pdfForm" method="post">
    <!-- –¢–ï–•–ù–ò–ß–ï–°–ö–ò–ï –î–ê–ù–ù–´–ï -->
    <fieldset>
      <legend>–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ
        <span class="info-icon" title="–û—Å–Ω–æ–≤–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∫–∞—Ä–∫–∞—Å–∞. –≠—Ç–∏ –∑–Ω–∞—á–µ–Ω–∏—è –≤–ª–∏—è—é—Ç –Ω–∞ —á–µ—Ä—Ç—ë–∂ –∏ —Ä–∞—Å—á—ë—Ç—ã. –ó–∞–ø–æ–ª–Ω—è—é—Ç—Å—è –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ.">üí¨</span>
      </legend>

      <div class="field-grid">
        <div class="field">
          <label>–ö–æ–ª-–≤–æ —á–∞—Å—Ç–µ–π –∫–∞—Ä–∫–∞—Å–∞, —à—Ç.:</label>
          <select name="frame_parts_count">
            <option value="1" selected>1</option>
            <option value="2">2</option>
            <option value="3">3</option>
          </select>
        </div>

        <div class="field">
          <label>–î–ª–∏–Ω–∞ –∫–∞—Ä–∫–∞—Å–∞, –º–º:</label>
          <input type="number" step="any" name="frame_length_mm" value="3000" required>
        </div>

        <div class="field">
          <label>–î–∏–∞–º–µ—Ç—Ä –∫–∞—Ä–∫–∞—Å–∞, –º–º:</label>
          <input type="number" step="any" name="frame_diameter_mm" value="110" required>
        </div>

        <div class="field">
          <label>–î–∏–∞–º–µ—Ç—Ä –ø—Ä–æ–¥–æ–ª—å–Ω–æ–≥–æ –ø—Ä—É—Ç–∫–∞, –º–º:</label>
          <input type="number" step="any" name="longitudinal_rod_diameter_mm" value="3" required>
        </div>

        <div class="field">
          <label>–î–∏–∞–º–µ—Ç—Ä –ø—Ä–æ–≤–æ–ª–æ–∫–∏ –∫–æ–ª—å—Ü–∞, –º–º:</label>
          <input type="number" step="any" name="ring_wire_diameter_mm" value="4" required>
        </div>

        <div class="field">
          <label>–ö–æ–ª-–≤–æ –ø—Ä—É—Ç–∫–æ–≤, —à—Ç.:</label>
          <select name="rod_count">
            <option value="6" selected>6</option>
            <option value="8">8</option>
            <option value="10">10</option>
            <option value="12">12</option>
            <option value="14">14</option>
            <option value="16">16</option>
            <option value="18">18</option>
            <option value="20">20</option>
            <option value="22">22</option>
            <option value="24">24</option>
          </select>
        </div>

        <div class="field">
          <label>–¢–∏–ø –∑–∞–º–∫–∞:</label>
          <select name="lock_type">
            <option value="–ë–µ–∑ –∑–∞–º–∫–∞" selected>–ë–µ–∑ –∑–∞–º–∫–∞</option>
            <option value="–ö–æ–≥–æ—Ç—å">–ö–æ–≥–æ—Ç—å</option>
          </select>
        </div>

        <div class="field">
          <label>–¢–∏–ø –ø–æ–∫—Ä—ã—Ç–∏—è:</label>
          <select name="coating_type">
            <option value="–ë–µ–∑ –æ–∫—Ä–∞—Å–∫–∏" selected>–ë–µ–∑ –æ–∫—Ä–∞—Å–∫–∏</option>
            <option value="–û–∫—Ä–∞—Å–∫–∞">–û–∫—Ä–∞—Å–∫–∞</option>
            <option value="–û—Ü–∏–Ω–∫–æ–≤–∫–∞">–û—Ü–∏–Ω–∫–æ–≤–∫–∞</option>
          </select>
        </div>

        <div class="field">
          <label>–¢–∏–ø –æ–≥–æ–ª–æ–≤–∫–∞:</label>
          <select name="head_type">
            <option value="–†–∞—Å—Ç—Ä—É–±" selected>–†–∞—Å—Ç—Ä—É–±</option>
            <option value="–í–æ—Ä–æ—Ç–Ω–∏–∫">–í–æ—Ä–æ—Ç–Ω–∏–∫</option>
          </select>
        </div>

        <div class="field">
          <label>–ú–∞—Ç–µ—Ä–∏–∞–ª –ø—Ä–æ–≤–æ–ª–æ–∫–∏:</label>
          <select name="wire_material">
            <option value="09–ì2–°" selected>09–ì2–°</option>
            <option value="–°–≤-08–ê">–°–≤-08–ê</option>
            <option value="12–•18–ù9">12–•18–ù9</option>
            <option value="12–•18–ù10–¢">12–•18–ù10–¢</option>
            <option value="08–•18–ù10">08–•18–ù10</option>
          </select>
        </div>

        <div class="field full-width">
          <div class="checkbox-label">
            <input type="checkbox" id="venturi_presence" name="venturi_presence">
            <label for="venturi_presence">–ù–∞–ª–∏—á–∏–µ –í–µ–Ω—Ç—É—Ä–∏</label>
          </div>
        </div>

        <div class="field">
          <label>–î–∏–∞–º–µ—Ç—Ä –í–µ–Ω—Ç—É—Ä–∏, –º–º:</label>
          <input type="number" step="any" name="venturi_diameter_mm" value="134" required>
        </div>

        <div class="field">
          <label>–¢–æ–ª—â–∏–Ω–∞ –í–µ–Ω—Ç—É—Ä–∏, –º–º:</label>
          <input type="number" step="any" name="venturi_thickness_mm" value="1" required>
        </div>

        <div class="field full-width">
          <div class="checkbox-label">
            <input type="checkbox" id="bottom_presence" name="bottom_presence" checked>
            <label for="bottom_presence">–ù–∞–ª–∏—á–∏–µ –¥–æ–Ω—ã—à–∫–∞</label>
          </div>
        </div>

        <div class="field">
          <label>–¢–æ–ª—â–∏–Ω–∞ –¥–æ–Ω—ã—à–∫–∞, –º–º:</label>
          <input type="number" step="any" name="bottom_thickness_mm" value="1" required>
        </div>

        <div class="field">
          <label>–í—ã—Å–æ—Ç–∞ –¥–æ–Ω—ã—à–∫–∞, –º–º:</label>
          <input type="number" step="any" name="bottom_length_mm" value="18" required>
        </div>

        <div class="field full-width">
          <div class="checkbox-label">
            <input type="checkbox" id="neck_ring_inner_diameter_presence" name="neck_ring_inner_diameter_presence">
            <label for="neck_ring_inner_diameter_presence">–í–Ω—É—Ç—Ä. –¥–∏–∞–º–µ—Ç—Ä –∫–æ–ª—å—Ü–∞ —Ä–∞—Å—Ç—Ä—É–±–∞ (–Ω–∞–Ω–æ—Å–∏—Ç—å —Ä–∞–∑–º–µ—Ä)</label>
          </div>
        </div>

        <div class="field full-width">
          <div class="inline-group">
            <input type="checkbox" id="neck_length_presence" name="neck_length_presence" checked>
            <label for="neck_length_presence">–ü–æ–∫–∞–∑—ã–≤–∞—Ç—å –¥–ª–∏–Ω—É –≥–æ—Ä–ª–æ–≤–∏–Ω—ã –Ω–∞ —á–µ—Ä—Ç–µ–∂–µ</label>
          </div>
        </div>

        <div class="field">
          <label>–î–ª–∏–Ω–∞ –≥–æ—Ä–ª–æ–≤–∏–Ω—ã, –º–º:</label>
          <input type="number" step="any" name="neck_length" value="230">
        </div>

        <div class="field">
          <label>–®–∞–≥ –º–µ–∂–¥—É –∫–æ–ª—å—Ü–∞–º–∏, –º–º:</label>
          <input type="number" step="any" name="distance_between_rings" value="193">
        </div>

        <div class="field full-width">
          <div class="inline-group">
            <input type="checkbox" id="last_ring_to_bottom_length_presence" name="last_ring_to_bottom_length_presence">
            <label for="last_ring_to_bottom_length_presence">–ü–æ–∫–∞–∑—ã–≤–∞—Ç—å —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –æ—Ç –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –∫–æ–ª—å—Ü–∞ –¥–æ –¥–æ–Ω—ã—à–∫–∞</label>
          </div>
        </div>

        <div class="field">
          <label>–†–∞—Å—Å—Ç–æ—è–Ω–∏–µ –æ—Ç –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –∫–æ–ª—å—Ü–∞ –¥–æ –¥–æ–Ω—ã—à–∫–∞, –º–º:</label>
          <input type="number" step="any" name="last_ring_to_bottom_length" value="78">
        </div>

        <!-- <div class="field">
          <label>–ö–æ–ª-–≤–æ —à–∞–≥–æ–≤, —à—Ç.:</label>
          <input type="number" name="calc_segment_count" readonly>
        </div>

        <div class="field">
          <label>–ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–ª–∏–Ω—ã –∫–∞—Ä–∫–∞—Å–∞:</label>
          <input type="text" name="calc_frame_length" readonly>
          <div id="frame_length_formula"></div>
        </div> -->
      </div>
    </fieldset>

    <!-- –û–°–ù–û–í–ù–ê–Ø –ù–ê–î–ü–ò–°–¨ -->
    <fieldset>
      <legend>–û—Å–Ω–æ–≤–Ω–∞—è –Ω–∞–¥–ø–∏—Å—å
        <span class="info-icon" title="–î–∞–Ω–Ω—ã–µ, –∫–æ—Ç–æ—Ä—ã–µ –±—É–¥—É—Ç –æ—Ç–æ–±—Ä–∞–∂–µ–Ω—ã –≤ –æ—Å–Ω–æ–≤–Ω–æ–π –Ω–∞–¥–ø–∏—Å–∏ –Ω–∞ —á–µ—Ä—Ç–µ–∂–µ. –ó–∞–ø–æ–ª–Ω–∏—Ç–µ —Ñ–∞–º–∏–ª–∏–∏ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã—Ö —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤.">üí¨</span>
      </legend>

      <div class="field-grid">
        <div class="field">
          <label>–ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ:</label>
          <input type="text" name="component_identification" value="–ö–∞—Ä–∫–∞—Å" required>
        </div>

        <div class="field">
          <label>–†–∞–∑—Ä–∞–±–æ—Ç–∞–ª:</label>
          <input type="text" name="designer" value="">
        </div>

        <div class="field">
          <label>–ü—Ä–æ–≤–µ—Ä–∏–ª:</label>
          <input type="text" name="scrutineer" value="">
        </div>

        <div class="field">
          <label>–¢–µ—Ö. –∫–æ–Ω—Ç—Ä:</label>
          <input type="text" name="supervisor" value="">
        </div>

        <div class="field">
          <label>–ù–æ—Ä–º. –∫–æ–Ω—Ç—Ä:</label>
          <input type="text" name="document_controller" value="">
        </div>

        <div class="field">
          <label>–£—Ç–≤–µ—Ä–¥–∏–ª:</label>
          <input type="text" name="confirmer" value="">
        </div>
      </div>
    </fieldset>


    <!-- –ò–ú–Ø –§–ê–ô–õ–ê -->
    <fieldset>
      <legend>–ò–º—è —Ñ–∞–π–ª–∞
        <span class="info-icon" title="–ò–º—è —Ñ–∞–π–ª–∞, —Å –∫–æ—Ç–æ—Ä—ã–º –±—É–¥–µ—Ç —Å–æ—Ö—Ä–∞–Ω—ë–Ω —á–µ—Ä—Ç—ë–∂. –ë–µ–∑ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è. –ú–æ–∂–Ω–æ –æ—Å—Ç–∞–≤–∏—Ç—å –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é.">üí¨</span> 
      </legend>

      <div class="field-grid">
        <div class="field full-width">
          <label>–ò–º—è —Ñ–∞–π–ª–∞ (–±–µ–∑ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è):</label>
          <input type="text" name="filename" value="drawing" required>
        </div>
      </div>
    </fieldset>

    <button type="submit">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å —á–µ—Ä—Ç—ë–∂</button>
  </form>











<script>
  // –¢–æ–∫–µ–Ω –ø—Ä–∏—Ö–æ–¥–∏—Ç –∏–∑ Flask
  const API_TOKEN = "{{ api_token }}";

  document.getElementById("pdfForm").addEventListener("submit", async (e) => {
    e.preventDefault();
    const form = e.target;
    const formData = new FormData(form);

    const filename = form.elements["filename"].value || "drawing";

    try {
      const response = await fetch("/generate", {
        method: "POST",
        headers: {
          "Authorization": "Bearer " + API_TOKEN
        },
        body: formData
      });

      if (!response.ok) {
        let message = `HTTP ${response.status}`;
        try {
          const error = await response.json();
          if (error && error.error) {
            message = error.error;
          }
        } catch (_) {}
        alert("–û—à–∏–±–∫–∞: " + message);
        return;
      }

      const blob = await response.blob();
      const link = document.createElement("a");
      link.href = URL.createObjectURL(blob);

      const safeName = filename.replace(/[^a-zA-Z–∞-—è–ê-–Ø0-9_\-]/g, "_");
      link.download = `${safeName}.pdf`;
      link.click();
    } catch (err) {
      alert("–û—à–∏–±–∫–∞ —Å–µ—Ç–∏ –∏–ª–∏ —Å–µ—Ä–≤–µ—Ä–∞: " + err.message);
    }
  });

    //   // === –î–∏–Ω–∞–º–∏–∫–∞ —Ñ–æ—Ä–º—ã –∫–∞–∫ –≤ GUI ===
    // (function initDynamicLogic() {
    //   // –£—Ç–∏–ª–∏—Ç–∞: –±–µ–∑–æ–ø–∞—Å–Ω–æ–µ –ø–æ–ª—É—á–µ–Ω–∏–µ —ç–ª–µ–º–µ–Ω—Ç–∞ –ø–æ –∏–º–µ–Ω–∏
    //   const byName = (name) => document.querySelector(`[name="${name}"]`);

    //   const frameParts = byName("frame_parts_count");
    //   const lockType = byName("lock_type");
    //   const wireMaterial = byName("wire_material");
    //   const coatingType = byName("coating_type");
    //   const bottomPresence = byName("bottom_presence");
    //   const bottomThickness = byName("bottom_thickness_mm");
    //   const bottomLength = byName("bottom_length_mm");
    //   const bottomDiameter = byName("bottom_diameter");
    //   const venturiPresence = byName("venturi_presence");
    //   const venturiDiameter = byName("venturi_diameter_mm");
    //   const venturiThickness = byName("venturi_thickness_mm");
    //   const neckRingPresence = byName("neck_ring_inner_diameter_presence");
    //   const headType = byName("head_type");
    //   const neckLengthPresence = byName("neck_length_presence");
    //   const neckLength = byName("neck_length");
    //   const lastRingPresence = byName("last_ring_to_bottom_length_presence");
    //   const lastRing = byName("last_ring_to_bottom_length");
    //   const frameLength = byName("frame_length_mm");
    //   const distanceBetweenRings = byName("distance_between_rings");
    //   const calcSegmentCount = byName("calc_segment_count");
    //   const calcFrameLength = byName("calc_frame_length");
    //   const formulaEl = document.getElementById("frame_length_formula");

    //   // –ü–æ–º–æ—â–Ω–∏–∫ –¥–ª—è "–ª–æ–≥–∏—á–µ—Å–∫–æ–≥–æ disabled", —á—Ç–æ–±—ã –ø–æ–ª—è –≤—Å—ë —Ä–∞–≤–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª—è–ª–∏—Å—å
    //   function setDisabledLike(el, disabled) {
    //     if (!el) return;
    //     el.readOnly = disabled && el.tagName === "INPUT";
    //     if (el.tagName === "SELECT") {
    //       el.dataset.disabledLike = disabled ? "1" : "0";
    //     }
    //     if (disabled) {
    //       el.classList.add("disabled-like");
    //     } else {
    //       el.classList.remove("disabled-like");
    //     }
    //   }

    //   function setResultClass(el, level) {
    //     if (!el) return;
    //     el.classList.add("result-field");
    //     el.classList.remove("result-ok", "result-warn", "result-error");
    //     if (level === "ok") el.classList.add("result-ok");
    //     else if (level === "warn") el.classList.add("result-warn");
    //     else if (level === "error") el.classList.add("result-error");
    //   }


    //   // –ï—Å–ª–∏ —É select —Å—Ç–æ–∏—Ç data-disabled-like=1 ‚Äî –Ω–µ –¥–∞—ë–º –º–µ–Ω—è—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ
    //   document.addEventListener("change", (e) => {
    //     const el = e.target;
    //     if (el.tagName === "SELECT" && el.dataset.disabledLike === "1") {
    //       // –æ—Ç–∫–∞—Ç—ã–≤–∞–µ–º –∑–Ω–∞—á–µ–Ω–∏–µ –Ω–∞–∑–∞–¥
    //       if (el.dataset.prevValue != null) {
    //         el.value = el.dataset.prevValue;
    //       }
    //     } else if (el.tagName === "SELECT") {
    //       el.dataset.prevValue = el.value;
    //     }
    //   });

    //   // --- 1. –ê–≤—Ç–æ–ø–æ–¥—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–º–∫–∞ –ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É —á–∞—Å—Ç–µ–π + —Å—Ç–æ—Ä–æ–∂ ---
    //   function updateLockTypeByFrameParts() {
    //     if (!frameParts || !lockType) return;
    //     const v = frameParts.value;
    //     const map = {
    //       "1": "–ë–µ–∑ –∑–∞–º–∫–∞",
    //       "2": "–ö–æ–≥–æ—Ç—å",
    //       "3": "–ö–æ–≥–æ—Ç—å"
    //     };
    //     const mapped = map[v];
    //     if (mapped && Array.from(lockType.options).some(o => o.value === mapped)) {
    //       lockType.value = mapped;
    //     }
    //     // –ü—Ä–∏ 1 —á–∞—Å—Ç–∏ –ª–æ–≥–∏—á–µ—Å–∫–∏ –±–ª–æ–∫–∏—Ä—É–µ–º –≤—ã–±–æ—Ä –∑–∞–º–∫–∞
    //     const disable = (v === "1");
    //     setDisabledLike(lockType, disable);
    //   }

    //   function guardLockType() {
    //     if (!frameParts || !lockType) return;
    //     const parts = frameParts.value;
    //     const lock = lockType.value;
    //     if ((parts === "2" || parts === "3") && lock === "–ë–µ–∑ –∑–∞–º–∫–∞") {
    //       alert(
    //         "–î–ª—è –∫–∞—Ä–∫–∞—Å–∞ –∏–∑ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —á–∞—Å—Ç–µ–π –∑–∞–º–æ–∫ –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω.\n" +
    //         "–¢–∏–ø –∑–∞–º–∫–∞ –±—É–¥–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏–∑–º–µ–Ω—ë–Ω."
    //       );
    //       lockType.value = "–ö–æ–≥–æ—Ç—å";
    //     }
    //   }

    //   // --- 2. –ê–≤—Ç–æ–ø–æ–¥—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–æ–∫—Ä—ã—Ç–∏—è –ø–æ –º–∞—Ç–µ—Ä–∏–∞–ª—É + —Å—Ç–æ—Ä–æ–∂ ---
    //   const stainlessList = ["12–•18–ù9", "12–•18–ù10–¢", "08–•18–ù10"];

    //   function updateCoatingByMaterial() {
    //     if (!wireMaterial || !coatingType) return;
    //     const wm = wireMaterial.value;
    //     if (stainlessList.includes(wm)) {
    //       coatingType.value = "–ë–µ–∑ –æ–∫—Ä–∞—Å–∫–∏";
    //     }
    //   }

    //   function guardCoating() {
    //     if (!wireMaterial || !coatingType) return;
    //     const wm = wireMaterial.value;
    //     const coat = coatingType.value;
    //     if (stainlessList.includes(wm) && (coat === "–û–∫—Ä–∞—Å–∫–∞" || coat === "–û—Ü–∏–Ω–∫–æ–≤–∫–∞")) {
    //       alert(
    //         "–î–ª—è –∫–∞—Ä–∫–∞—Å–∞ –∏–∑ –Ω–µ—Ä–∂–∞–≤–µ–π–∫–∏ –ø–æ–∫—Ä—ã—Ç–∏–µ –∏ –æ–∫—Ä–∞—à–∏–≤–∞–Ω–∏–µ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è.\n" +
    //         "–¢–∏–ø –ø–æ–∫—Ä—ã—Ç–∏—è –±—É–¥–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏–∑–º–µ–Ω—ë–Ω."
    //       );
    //       coatingType.value = "–ë–µ–∑ –æ–∫—Ä–∞—Å–∫–∏";
    //     }
    //   }

    //   // --- 3. –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –Ω–∞–ª–∏—á–∏—è –¥–æ–Ω—ã—à–∫–∞ ---
    //   function updateBottomFields() {
    //     if (!bottomPresence) return;
    //     const noBottom = !bottomPresence.checked;
    //     setDisabledLike(bottomThickness, noBottom);
    //     setDisabledLike(bottomLength, noBottom);
    //     setDisabledLike(bottomDiameter, noBottom);
    //   }

    //   // --- 4. –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –Ω–∞–ª–∏—á–∏—è –í–µ–Ω—Ç—É—Ä–∏ ---
    //   function updateVenturiFields() {
    //     if (!venturiPresence) return;
    //     const hasVenturi = venturiPresence.checked;
    //     // –ï—Å–ª–∏ –í–µ–Ω—Ç—É—Ä–∏ –Ω–µ—Ç ‚Äî –≥–∞—Å–∏–º –µ–≥–æ —Ä–∞–∑–º–µ—Ä—ã
    //     setDisabledLike(venturiDiameter, !hasVenturi);
    //     setDisabledLike(venturiThickness, !hasVenturi);
    //     // –ï—Å–ª–∏ –í–µ–Ω—Ç—É—Ä–∏ –µ—Å—Ç—å ‚Äî –≥–∞—Å–∏–º —á–µ–∫–±–æ–∫—Å –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–≥–æ –¥–∏–∞–º–µ—Ç—Ä–∞ –∫–æ–ª—å—Ü–∞ —Ä–∞—Å—Ç—Ä—É–±–∞
    //     if (neckRingPresence) {
    //       setDisabledLike(neckRingPresence, hasVenturi);
    //       if (hasVenturi) {
    //         neckRingPresence.checked = false;
    //       }
    //     }
    //   }

    //   // --- 5. –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç—å neck_ring_inner_diameter_presence –æ—Ç head_type ---
    //   function updateNeckRingByHeadType() {
    //     if (!headType || !neckRingPresence) return;
    //     const type = headType.value;
    //     const disable = (type !== "–†–∞—Å—Ç—Ä—É–±");
    //     setDisabledLike(neckRingPresence, disable);
    //     if (disable) {
    //       neckRingPresence.checked = false;
    //     }
    //   }

    //   // --- 6. –°–ø—Ä–∞–≤–æ—á–Ω—ã–µ —Ä–∞–∑–º–µ—Ä—ã: –Ω–∞–ª–∏—á–∏–µ / –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ ---
    //   function updateNeckLengthField() {
    //     if (!neckLengthPresence || !neckLength) return;
    //     const enabled = neckLengthPresence.checked;
    //     setDisabledLike(neckLength, !enabled);
    //   }

    //   function updateLastRingField() {
    //     if (!lastRingPresence || !lastRing) return;
    //     const enabled = lastRingPresence.checked;
    //     setDisabledLike(lastRing, !enabled);
    //   }

    //   function recomputeFrameLengthCheck() {
    //     if (!frameLength || !neckLength || !distanceBetweenRings || !lastRing || !calcSegmentCount || !calcFrameLength) {
    //       return;
    //     }

    //     const L = parseFloat(frameLength.value);
    //     const neck = parseFloat(neckLength.value);
    //     const step = parseFloat(distanceBetweenRings.value);
    //     const last = parseFloat(lastRing.value);

    //     if ([L, neck, step, last].some(v => !isFinite(v) || v <= 0)) {
    //       calcSegmentCount.value = "";
    //       calcFrameLength.value = "–û—à–∏–±–∫–∞";
    //       if (formulaEl) formulaEl.textContent = "";
    //       setResultClass(calcFrameLength, "error");  // –∫—Ä–∞—Å–Ω–∞—è –∏–Ω–¥–∏–∫–∞—Ü–∏—è
    //       return;
    //     }

    //     // --- —É—á—ë—Ç –∑–∞–º–∫–æ–≤ ---
    //     const LOCK_DELTA = 24; // –º–º –Ω–∞ –æ–¥–∏–Ω –∑–∞–º–æ–∫
    //     let lockCount = 0;
    //     if (frameParts) {
    //       const parts = parseInt(frameParts.value, 10);
    //       if (isFinite(parts) && parts > 1) {
    //         lockCount = parts - 1; // –∑–∞–º–∫–æ–≤ –≤—Å–µ–≥–¥–∞ –Ω–∞ –æ–¥–∏–Ω –º–µ–Ω—å—à–µ —á–∞—Å—Ç–µ–π
    //       }
    //     }
    //     const lockAdd = lockCount * LOCK_DELTA; // –æ–±—â–∏–π –≤–∫–ª–∞–¥ –∑–∞–º–∫–æ–≤ –≤ –¥–ª–∏–Ω—É

    //     // —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–∞—è –¥–ª–∏–Ω–∞ –ø–æ–¥ —à–∞–≥–∏ (—à–∞–≥–∏ –∑–∞–Ω–∏–º–∞—é—Ç —Ç–æ–ª—å–∫–æ –æ—Å—Ç–∞–≤—à–µ–µ—Å—è)
    //     const usable = L - neck - last - lockAdd;
    //     if (usable <= 0) {
    //       calcSegmentCount.value = "‚Äî";
    //       const msg = "–ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ —Ä–∞–∑–º–µ—Ä—ã: –¥–ª–∏–Ω–∞ –∫–∞—Ä–∫–∞—Å–∞ –º–µ–Ω—å—à–µ —Å—É–º–º—ã –≥–æ—Ä–ª–æ–≤–∏–Ω—ã, —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è –¥–æ –¥–æ–Ω—ã—à–∫–∞ –∏ –∑–∞–º–∫–æ–≤";
    //       calcFrameLength.value = msg;

    //       if (formulaEl) {
    //         const lockPartText = lockCount > 0
    //           ? ` + ${lockCount} √ó ${LOCK_DELTA.toFixed(1)}`
    //           : "";
    //         formulaEl.textContent =
    //           `${neck.toFixed(1)} + ? √ó ${step.toFixed(1)} + ${last.toFixed(1)}${lockPartText} ‚â† ${L.toFixed(1)} –º–º`;
    //       }

    //       setResultClass(calcFrameLength, "error");
    //       return;
    //     }

    //     // –ü–æ–¥–±–æ—Ä –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —à–∞–≥–æ–≤ (–∫–æ–ª–µ—Ü)
    //     const nSteps = Math.round(usable / step);
    //     const reconstructed = neck + nSteps * step + last + lockAdd;
    //     const diff = reconstructed - L;
    //     const diffAbs = Math.abs(diff);

    //     calcSegmentCount.value = nSteps;

    //     const toleranceOk = 1;   // –¥–æ 1 –º–º —Å—á–∏—Ç–∞–µ–º —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ–º
    //     const toleranceWarn = 10; // –¥–∞–ª—å—à–µ ‚Äî –ø—Ä–æ—Å—Ç–æ –¥–≤–∞ —É—Ä–æ–≤–Ω—è –ø–æ —Ü–≤–µ—Ç–∞–º

    //     let statusText;

    //     if (diffAbs <= toleranceOk) {
    //       // 1Ô∏è‚É£ –í—Å—ë —Å–æ—à–ª–æ—Å—å ‚Äî –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –∑–Ω–∞—á–µ–Ω–∏—è —á–µ—Ä–µ–∑ "="
    //       // reconstructed ‚Äî —Ä–∞—Å—á—ë—Ç–Ω–æ–µ, L ‚Äî –≤–≤–µ–¥—ë–Ω–Ω–æ–µ
    //       statusText = `${reconstructed.toFixed(0)} = ${L.toFixed(0)} –º–º`;
    //       setResultClass(calcFrameLength, "ok");
    //     } else {
    //       // 2Ô∏è‚É£ –ï—Å—Ç—å —Ä–∞—Å—Ö–æ–∂–¥–µ–Ω–∏–µ ‚Äî –ø–æ–∫–∞–∑—ã–≤–∞–µ–º > –∏–ª–∏ <
    //       const sign = (reconstructed > L) ? ">" : "<";
    //       statusText = `${reconstructed.toFixed(0)} ${sign} ${L.toFixed(0)} –º–º`;

    //       // –¶–≤–µ—Ç–æ–≤–∞—è –∏–Ω–¥–∏–∫–∞—Ü–∏—è –æ—Å—Ç–∞—ë—Ç—Å—è –ø–æ –ø–æ—Ä–æ–≥–∞–º
    //       if (diffAbs <= toleranceWarn) {
    //         setResultClass(calcFrameLength, "warn");
    //       } else {
    //         setResultClass(calcFrameLength, "error");
    //       }
    //     }

    //     // –í—ã–≤–æ–¥–∏–º —Ç–µ–∫—Å—Ç –≤ –ø–æ–ª–µ
    //     calcFrameLength.value = statusText;


    //     if (formulaEl) {
    //       const lockPartText = lockCount > 0
    //         ? ` + ${lockCount} √ó ${LOCK_DELTA.toFixed(0)}`
    //         : "";
    //       formulaEl.textContent =
    //         `${neck.toFixed(0)} + ${nSteps} √ó ${step.toFixed(0)} + ${last.toFixed(0)}${lockPartText} = ` +
    //         `${reconstructed.toFixed(0)} –º–º; L = ${L.toFixed(0)} –º–º; Œî = ${diff.toFixed(0)} –º–º`;
    //     }
    //   }



    //   // --- –ü–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ —Å–æ–±—ã—Ç–∏—è ---
    //   if (frameParts) {
    //     frameParts.addEventListener("change", () => {
    //       updateLockTypeByFrameParts();
    //       guardLockType();
    //       recomputeFrameLengthCheck();
    //     });
    //   }
    //   if (lockType) {
    //     lockType.addEventListener("change", guardLockType);
    //   }

    //   if (wireMaterial) {
    //     wireMaterial.addEventListener("change", () => {
    //       updateCoatingByMaterial();
    //       guardCoating();
    //     });
    //   }
    //   if (coatingType) {
    //     coatingType.addEventListener("change", guardCoating);
    //   }

    //   if (bottomPresence) {
    //     bottomPresence.addEventListener("change", updateBottomFields);
    //   }
    //   if (venturiPresence) {
    //     venturiPresence.addEventListener("change", () => {
    //       updateVenturiFields();
    //     });
    //   }
    //   if (headType) {
    //     headType.addEventListener("change", () => {
    //       updateNeckRingByHeadType();
    //     });
    //   }
    //   if (neckLengthPresence) {
    //     neckLengthPresence.addEventListener("change", updateNeckLengthField);
    //   }
    //   if (lastRingPresence) {
    //     lastRingPresence.addEventListener("change", updateLastRingField);
    //   }

    //   // üëâ –ü–µ—Ä–µ—Å—á—ë—Ç –¥–ª–∏–Ω—ã –∫–∞—Ä–∫–∞—Å–∞ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –≤—Ö–æ–¥–Ω—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
    //   [frameLength, neckLength, distanceBetweenRings, lastRing].forEach(el => {
    //     if (el) {
    //       el.addEventListener("input", recomputeFrameLengthCheck);
    //       el.addEventListener("change", recomputeFrameLengthCheck);
    //     }
    //   });

    //   // --- –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã ---
    //   updateLockTypeByFrameParts();
    //   updateCoatingByMaterial();
    //   guardCoating();
    //   updateBottomFields();
    //   updateVenturiFields();
    //   updateNeckRingByHeadType();
    //   updateNeckLengthField();
    //   updateLastRingField();
      
    //   // üîí –¢–∏–ø –æ–≥–æ–ª–æ–≤–∫–∞ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π ‚Äî '–†–∞—Å—Ç—Ä—É–±', –º–µ–Ω—è—Ç—å –µ–≥–æ –Ω–µ–ª—å–∑—è
    //   if (headType) {
    //     setDisabledLike(headType, true);
    //   }

    //   // üëâ –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–ª–∏–Ω—ã –∫–∞—Ä–∫–∞—Å–∞ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ
    //   recomputeFrameLengthCheck();
    // })();
</script>



  <!-- –í–∞—Ä–∏–∞–Ω—Ç –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–π –æ—Ç–ª–∞–¥–∫–∏ (–µ—Å–ª–∏ —Å–µ—Ä–≤–µ—Ä —Å–ª—É—à–∞–µ—Ç localhost:5000)
  <script>
    document.getElementById("pdfForm").addEventListener("submit", async (e) => {
      e.preventDefault();
      const formData = new FormData(e.target);
      const filename = e.target.elements["filename"].value || "drawing";

      const response = await fetch("http://localhost:5000/generate", {
        method: "POST",
        headers: {
          "Authorization": "Bearer secure_token_Aspex"
        },
        body: formData
      });

      if (response.ok) {
        const blob = await response.blob();
        const link = document.createElement("a");
        link.href = URL.createObjectURL(blob);
        const safeName = filename.replace(/[^a-zA-Z–∞-—è–ê-–Ø0-9_\-]/g, "_");
        link.download = `${safeName}.pdf`;
        link.click();
      } else {
        const error = await response.json();
        alert("–û—à–∏–±–∫–∞: " + error.error);
      }
    });
  </script>
  -->

</body>
</html>
